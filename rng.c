#include "rng.h"
#include <stdint.h>

static uint32_t rng_table_p[256] = {
	495,171,274,426,328,325,135,6,387,373,157,58,327,94,92,133,47,301,124,483,417,
	261,441,272,467,242,76,461,365,321,217,337,392,19,372,429,15,454,257,20,100,472,
	391,291,329,53,178,382,224,445,190,136,237,430,246,497,130,360,172,2,469,201,162,
	207,39,465,283,493,212,188,177,151,181,69,353,64,204,352,336,161,479,499,89,446,
	421,179,110,267,318,27,208,270,5,156,330,284,221,255,61,14,223,214,147,263,400,
	358,213,419,220,24,18,141,386,142,114,185,490,22,59,55,137,468,473,119,334,202,
	393,250,415,302,355,23,290,98,10,305,42,152,412,112,226,404,276,385,414,71,312,
	150,453,26,480,227,132,319,258,251,143,345,228,363,362,131,88,215,378,306,273,
	195,285,452,298,437,354,295,247,225,173,233,9,74,502,279,72,40,193,326,366,49,
	260,210,229,91,405,4,428,287,411,384,183,28,439,313,381,496,402,317,299,165,397,
	168,84,297,206,311,422,410,153,140,155,99,241,348,418,492,484,145,304,314,109,
	36,275,154,371,198,475,78,420,451,67,394,481,458,175,192,95,323,176,423,138,196,
	13,495,171,274,426,328,
};

void rng_init(rng_state_s *dice) {
	int i;
	for (i = 0; i < 256; i ++) {
		dice->table[i] = rng_table_p[i];
	}
	dice->index = 0;
}

uint32_t rng_next(rng_state_s *dice) {
	dice->index ++;
	dice->index &= 0xFF;
	return dice->table[dice->index];
}
